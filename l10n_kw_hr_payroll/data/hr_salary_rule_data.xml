<odoo>
    <data noupdate="1">
        <record id="kuwait_housing_allowance_salary_rule" model="hr.salary.rule">
            <field name="name">Housing Allowance</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="code">HOUSALLOW</field>
            <field name="sequence">4</field>
            <field name="condition_python">result = contract.housing_allowance>0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.housing_allowance</field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>
        <record id="kuwait_transportation_allowance_salary_rule" model="hr.salary.rule">
            <field name="name">Transportation Allowance</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="code">TRASALLOW</field>
            <field name="sequence">4</field>
            <field name="condition_python">result = contract.transportation_allowance>0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.transportation_allowance</field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>
        <record id="kuwait_other_allowances_salary_rule" model="hr.salary.rule">
            <field name="name">Other Allowances</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="code">OTHALLOW</field>
            <field name="sequence">4</field>
            <field name="condition_python">result = contract.other_allowances>0</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = contract.other_allowances</field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>

        <record id="kuwait_overtime" model="hr.salary.rule">
            <field name="name">Overtime</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="code">OT</field>
            <field name="sequence">5</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = worked_days.OT and worked_days.OT.number_of_hours and contract.resource_calendar_id.hours_per_day
            </field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
result = 1.5 * worked_days.OT.number_of_hours * (contract.wage )/((payslip.date_to - payslip.date_from).days+1)/contract.resource_calendar_id.hours_per_day
            </field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>
        <record id="kuwait_accrude_annual_leaves_salary_rule" model="hr.salary.rule">
            <field name="name">Accrude Annual Leaves</field>
            <field name="category_id" ref="l10n_kw_hr_payroll.COMP"/>
            <field name="code">AAL</field>
            <field name="sequence">5</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
start_date = contract.date_start
end_date = contract.date_end
day_rate = float( contract.wage /contract.basic_number_of_days)
difference = ((end_date-start_date).days/365)*30
result = day_rate  * difference
            </field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>
        <record id="kuwait_end_of_service_salary_rule" model="hr.salary.rule">
            <field name="name">End Of Service</field>
            <field name="category_id" ref="hr_payroll.ALW"/>
            <field name="code">EOS</field>
            <field name="sequence">80</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = not employee.active and employee.departure_reason_id</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">
start_date = contract.first_contract_date
end_date = contract.date_end
compensation = contract.wage + contract.housing_allowance + contract.transportation_allowance + contract.other_allowances
day_rate = float( compensation /contract.basic_number_of_days)
worked_days = (end_date-start_date).days
worked_years = float(worked_days /365)
eos_limit = compensation * 18
eos=0
#before 5 years computation
if worked_years &lt;=5 :
    eos = worked_years * 15 * day_rate

# After 5 years computing
if worked_years >5:
    ra = worked_years -5
    eos= (75 * day_rate )+ (compensation*ra)

#EOS departure computing cases ( 3/12= 0.25  => 3 month test of contract )
if 0.25 &lt; worked_years &lt; 3:
    result= 0 if employee.departure_reason_id != contract.env.ref('hr.departure_fired') else eos
elif 3 &lt;= worked_years &lt;= 5:
    result= eos* 1 / 2 if employee.departure_reason_id != contract.env.ref('hr.departure_fired') else eos
elif  5 &lt;= worked_years &lt; 10:
    result= eos* 2 / 3 if employee.departure_reason_id != contract.env.ref('hr.departure_fired') else eos
else:
    #case if he worked more than 10 years, he has full end of service with limit of 18 months
    result= eos if eos &lt; eos_limit else eos_limit
result = payslip.dict.company_id.currency_id.round(result)
</field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>
        <record id="kuwait_end_of_service_provision_salary_rule" model="hr.salary.rule">
            <field name="name">End of Service Provision</field>
            <field name="category_id" ref="hr_payroll.COMP"/>
            <field name="code">EOSP</field>
            <field name="appears_on_payslip">False</field>
            <field name="sequence">90</field>
            <field name="condition_select">python</field>
            <field name="condition_python">result = employee.active</field>
            <field name="amount_select">code</field>
            <field name="amount_python_compute">result = (30 / 365) * (contract.wage + contract.housing_allowance + contract.transportation_allowance + contract.other_allowances)</field>
            <field name="struct_id" ref="l10n_kw_hr_payroll.kuwait_employee_payroll_structure"/>
        </record>
    </data>
</odoo>
